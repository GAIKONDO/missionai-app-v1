# トピックドキュメント

> **📋 ステータス**: アクティブ（ドキュメントインデックス）  
> **📅 最終更新**: 2025-12-11  
> **👤 用途**: トピックフォルダのドキュメント概要とナビゲーション

## 📋 フォルダ概要

このフォルダには、トピックデータの保存フローとトピック分離計画に関するドキュメントが含まれています。トピックは議事録内の個別のトピックを表し、AI生成されたエンティティ、リレーション、メタデータと関連付けられます。

## 📚 ドキュメント一覧

### 1. TOPIC_DATA_SAVE_FLOW.md
**ステータス**: アクティブ（実装仕様書）  
**用途**: トピックでAI生成したデータの保存先とベクトル（埋め込み）の保存先の説明

**内容**:
- データの保存先（トピックメタデータ、エンティティ、リレーション、埋め込みベクトル）
- 保存フロー（トピック保存時）
- 上書き保存の仕組み
- 確認方法
- 注意事項

**読むべき人**: 
- トピックデータの保存フローを理解したい開発者
- データの保存先を確認したい開発者

---

### 2. TOPIC_SEPARATION_PLAN.md
**ステータス**: 設計案（一部実装済み）  
**用途**: トピック分離の設計計画書

**内容**:
- 概要と目標
- 前提条件
- データベーススキーマ設計（`topics`テーブルの作成）
- 既存データの削除（オプション）
- コード変更（Rust側、TypeScript側）
- 後方互換性の確保
- 実装順序
- 注意事項
- テスト項目

**読むべき人**: 
- トピック分離の設計を理解したい開発者
- 今後の実装計画を確認したい開発者

**注意**: `topics`テーブルは既に実装済みですが、JSON内のトピックデータとの完全な分離は未実装の可能性があります。

---

## 🔗 ドキュメント間の関係

```
TOPIC_DATA_SAVE_FLOW.md
    ↓ (参照)
TOPIC_SEPARATION_PLAN.md
    ↓ (参照)
データベース設計 (../database/database-design.md)
    ↓ (参照)
埋め込みベクトルの保存場所 (../database/EMBEDDING_STORAGE_LOCATIONS.md)
```

**関係の説明**:
1. **TOPIC_DATA_SAVE_FLOW.md** は、現在の実装におけるトピックデータの保存フローを説明します。
2. **TOPIC_SEPARATION_PLAN.md** は、トピック分離の設計計画を説明します（一部実装済み）。
3. **データベース設計** は、SQLiteデータベースの設計を説明します。
4. **埋め込みベクトルの保存場所** は、ChromaDBへの埋め込み保存の詳細を説明します。

## 📖 読み方ガイド

### トピックデータの保存フローを理解する場合

1. **TOPIC_DATA_SAVE_FLOW.md** を読む
   - データの保存先を理解
   - 保存フローを確認
   - 上書き保存の仕組みを理解

2. **埋め込みベクトルの保存場所** を参照
   - ChromaDBへの埋め込み保存の詳細を確認

### トピック分離の設計を理解する場合

1. **TOPIC_SEPARATION_PLAN.md** を読む
   - 設計計画を理解
   - 実装順序を確認

2. **データベース設計** を参照
   - `topics`テーブルの構造を確認

## 🔄 更新ポリシー

- **TOPIC_DATA_SAVE_FLOW.md**: 保存フローが変更された場合、またはテーブル名が変更された場合に更新
- **TOPIC_SEPARATION_PLAN.md**: 実装状況が変更された場合、または設計計画が更新された場合に更新

## 📝 重要な変更履歴

### 2025-01-15
- **TOPIC_DATA_SAVE_FLOW.md**: 
  - テーブル名を修正（`topicRelations` → `relations`、`topicEmbeddings` → `topics`）
  - ChromaDBへの埋め込み生成が実装済みであることを反映
  - トピック検索にSQLiteフォールバックがないことを明記
  - ステータスヘッダーを追加
  - 関連ドキュメントへのリンクを追加

- **TOPIC_SEPARATION_PLAN.md**: 
  - `topics`テーブルが実装済みであることを反映
  - 実装状況を明記
  - ステータスヘッダーを追加
  - 関連ドキュメントへのリンクを追加

## 🔗 関連ドキュメント

### データベース関連
- [データベース設計](../database/database-design.md) - SQLiteデータベースの設計
- [埋め込みベクトルの保存場所](../database/EMBEDDING_STORAGE_LOCATIONS.md) - 埋め込みベクトルの保存場所の詳細

### ChromaDB関連
- [ChromaDB統合計画](../chromadb/CHROMADB_INTEGRATION_PLAN.md) - ChromaDB統合の実装計画
- [ChromaDB使用ガイド](../chromadb/CHROMADB_USAGE_GUIDE.md) - ChromaDBのセットアップとトラブルシューティング

### RAG検索関連
- [RAG検索システム評価レポート](../rag-search/RAG_SEARCH_EVALUATION.md) - RAG検索システムの評価と改善提案
- [検索時のデータベース参照フロー](../rag-search/SEARCH_DATABASE_FLOW.md) - 検索フローの詳細

## 📌 注意事項

1. **テーブル名の変更**: 
   - `topicRelations` → `relations`（リネーム済み）
   - `topicEmbeddings` → `topics`（統合済み）
   - `entityEmbeddings`と`relationEmbeddings`は現在は使用されていません

2. **ChromaDBへの埋め込み生成**: 
   - トピックの埋め込みベクトルはChromaDBの`topics_{organizationId}`コレクションに保存されます
   - SQLiteの`topics`テーブルにはメタデータのみ保存されます

3. **トピック検索**: 
   - トピック検索にはSQLiteフォールバックはありません
   - ChromaDBが無効な場合、検索結果は空になります

4. **上書き保存**: 
   - トピック保存時は、既存のエンティティとリレーションが削除され、新しいデータが保存されます

5. **実装状況**: 
   - `topics`テーブルは既に実装済みです
   - JSON内のトピックデータとの完全な分離は未実装の可能性があります
